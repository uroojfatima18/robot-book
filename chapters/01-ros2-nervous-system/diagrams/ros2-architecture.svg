<?xml version="1.0" encoding="UTF-8"?>
<!--
  Chapter 1: The Robotic Nervous System (ROS 2)
  Diagram: ROS 2 Architecture Overview
  Alt-text: ROS 2 architecture showing nodes communicating through DDS middleware
  with topics, services, and actions connecting application layer to hardware
-->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500" role="img" aria-labelledby="title desc">
  <title id="title">ROS 2 Architecture Overview</title>
  <desc id="desc">Diagram showing the layered architecture of ROS 2, from application nodes at the top through middleware (DDS) to the operating system and hardware at the bottom. Nodes communicate via topics, services, and actions through the ROS 2 client libraries.</desc>

  <!-- Background -->
  <rect width="800" height="500" fill="#f8f9fa"/>

  <!-- Title -->
  <text x="400" y="35" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#1a1a2e">ROS 2 Architecture</text>

  <!-- Application Layer -->
  <rect x="50" y="60" width="700" height="100" rx="10" fill="#e8f4f8" stroke="#0077b6" stroke-width="2"/>
  <text x="400" y="85" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#0077b6">APPLICATION LAYER</text>

  <!-- Nodes -->
  <rect x="80" y="100" width="120" height="45" rx="5" fill="#0077b6" stroke="#023e8a" stroke-width="2"/>
  <text x="140" y="128" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">Camera Node</text>

  <rect x="230" y="100" width="120" height="45" rx="5" fill="#0077b6" stroke="#023e8a" stroke-width="2"/>
  <text x="290" y="128" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">Vision Node</text>

  <rect x="380" y="100" width="120" height="45" rx="5" fill="#0077b6" stroke="#023e8a" stroke-width="2"/>
  <text x="440" y="128" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">Planner Node</text>

  <rect x="530" y="100" width="120" height="45" rx="5" fill="#0077b6" stroke="#023e8a" stroke-width="2"/>
  <text x="590" y="128" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">Motor Node</text>

  <!-- ROS 2 Client Libraries Layer -->
  <rect x="50" y="180" width="700" height="70" rx="10" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
  <text x="400" y="205" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#856404">ROS 2 CLIENT LIBRARIES</text>
  <text x="200" y="230" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#856404">rclpy (Python)</text>
  <text x="400" y="230" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#856404">rclcpp (C++)</text>
  <text x="600" y="230" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#856404">rcl (Core)</text>

  <!-- Communication Patterns -->
  <rect x="50" y="270" width="700" height="60" rx="10" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
  <text x="400" y="290" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#155724">COMMUNICATION PATTERNS</text>
  <text x="175" y="315" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#155724">Topics (Pub/Sub)</text>
  <text x="400" y="315" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#155724">Services (Req/Res)</text>
  <text x="625" y="315" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#155724">Actions (Goal/Feedback)</text>

  <!-- DDS Middleware Layer -->
  <rect x="50" y="350" width="700" height="50" rx="10" fill="#f8d7da" stroke="#dc3545" stroke-width="2"/>
  <text x="400" y="382" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#721c24">DDS MIDDLEWARE (Data Distribution Service)</text>

  <!-- OS/Hardware Layer -->
  <rect x="50" y="420" width="700" height="60" rx="10" fill="#d1d1d1" stroke="#6c757d" stroke-width="2"/>
  <text x="400" y="445" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#495057">OPERATING SYSTEM &amp; HARDWARE</text>
  <text x="400" y="465" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#6c757d">Linux (Ubuntu) | Sensors | Actuators | Network</text>

  <!-- Arrows connecting layers -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#495057"/>
    </marker>
  </defs>

  <!-- Bidirectional arrows -->
  <line x1="400" y1="160" x2="400" y2="180" stroke="#495057" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="400" y1="250" x2="400" y2="270" stroke="#495057" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="400" y1="330" x2="400" y2="350" stroke="#495057" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="400" y1="400" x2="400" y2="420" stroke="#495057" stroke-width="2" marker-end="url(#arrowhead)"/>
</svg>
